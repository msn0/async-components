{"version":3,"sources":["../async-components.js"],"names":[],"mappings":"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","file":"async-components.es5.js","sourcesContent":["((document) => {\n\n  const COMPONENT_ATTR = 'data-component';\n  const DETAIL_ATTR = 'data-detail';\n  const EVENT_ATTR = 'data-event';\n\n  const OBSERVER_CONFIG = {\n    attributes: true,\n    childList: true,\n    characterData: false,\n    subtree: true,\n    attributeFilter: [COMPONENT_ATTR]\n  };\n\n  function getText(response) {\n    return response.text();\n  }\n\n  function parse(params) {\n    var detail = params.node.getAttribute(DETAIL_ATTR);\n    params.eventName = params.node.getAttribute(EVENT_ATTR);\n    try {\n      params.eventDetail = JSON.parse(detail);\n    } catch (e) {\n      params.eventDetail = detail;\n    }\n\n    return Promise.resolve(params);\n  }\n\n  function getData(node) {\n    return (text) => parse({\n      node: node,\n      text: text\n    });\n  }\n\n  function placeElement(params) {\n    params.node.outerHTML = params.text;\n    return Promise.resolve(params);\n  }\n\n  function dispatchEvent(params) {\n    var e = new CustomEvent(params.eventName, {\n      detail: {\n        node: params.node,\n        detail: params.detail\n      }\n    });\n    document.dispatchEvent(e);\n  }\n\n  function reportError() {\n    console.error(\"Error occured\");\n  }\n\n  function fetchComponent(node) {\n    var url = node.getAttribute(COMPONENT_ATTR);\n    var getNodeData = getData(node);\n\n    fetch(url)\n      .then(getText)\n      .then(getNodeData)\n      .then(placeElement)\n      .then(dispatchEvent)\n      .catch(reportError);\n  }\n\n  function filterComponents(node) {\n    return node.nodeType === 1 && node.getAttribute(COMPONENT_ATTR);\n  }\n\n  var observer = new MutationObserver((mutations) => {\n    mutations.forEach((mutation) => {\n      [].slice.call(mutation.addedNodes)\n        .filter(filterComponents)\n        .forEach((node) => setTimeout(fetchComponent(node), 0));\n    });\n  });\n\n  observer.observe(document.body, OBSERVER_CONFIG);\n\n})(document);\n"]}